---
prev: /algorithm/
next: /algorithm/ACM-Practice-Guide.md
---

# 模拟退火算法

::: tip 前言
模拟退火算法（SAA）和蚁群算法、遗传算法都是典型的启发式搜索算法
:::

## 简介

所谓的启发式搜索算法，就是在状态空间中的搜索对每一个搜索位置进行评估，得到最好位置，再从这个位置进行搜索直到目标。

![启发式搜索算法](/in-post/1.jpg "启发式搜索算法")

  模拟退火算法来源于固体的退火原理，将固体加热到充分高的温度，内部的粒子会随着温度升高而变成无序状，内能增大。在慢慢冷却的过程中粒子会逐渐有序，在每个温度都达到平衡态，最后在常温时达到基态，内能减为最小。

  看到这可能你会很懵，淡定点先别着急关掉，这段话你只要知道：固体在温度高的时候粒子无序不稳定，但随着温度的降低，粒子它会逐渐冷♂静下来。记住这点，后面我们会展开来说。

## 爬山算法

  为了更好理解模拟退火算法，我们先来聊聊爬山算法。爬山算法是典型的贪心算法，但它是一种目光短浅的贪心算法，每次都仅仅是选择相对于自己当前位置的一个最优解，所以爬山算法只能搜索到局部的最优解。

![兔子](/in-post/2.png "兔子")

像上图 ，如果有一只兔子在C点，它根据爬山算法最高只能到达A点，因为到达A点后它只能看到周围的C点和E点，而这两点都比A点低，也就是说它往任何一个方向移动都不能得到一个相比于当前位置更优的解，所以它就这样停下来了。

模拟退火也是贪心算法，但是不同于爬山算法的地方是，它在搜索的过程中加入了随机因子，它会有一定的概率接受一个比当前解要差的解，所以它具有跳出局部最优陷阱的优越性。通俗的来说，刚才那个兔子它在A点的时候，它会有一定的概率往比A点低的E点跳。经过多几次这样的不是局部最优的跳动，它就能到达D点，也就跳出了局部最优解A，在它面前的是更高的B(全局最优解)。

这里的一定概率的计算，就是参考了固体退火原理，这也是为什么这个算法叫做模拟退火的原因。

根据热力学的原理，在温度为T时，出现能量差为dE的降温的概率为P(dE)，表示为：

$$
P(dE) = exp( \frac{dE}{kT} )
$$

其中k是一个常数，exp表示自然指数，且dE<0（因为是降温）。

用大白话来说就是温度越高，粒子越是无序，出现能量差为dE的降温概率就越大，温度越低，粒子逐渐稳定，出现这样的降温可能就越小。我们将一次向较差解的移动看做是降温，接受这次移动的一定概率就是P(dE)。

我们再拿兔子来举个栗子:

*爬山算法:兔子每次都会往更高的地方跳，但它不一定能跳到最高的山峰，它可能跳到了一个小土坡，因为近处没有更高的地方可以跳，就停下来了。所以说爬山算法是目光短浅的，它不能保证局部最优解就是全局最优解。

*模拟退火:兔子一开始心里没什么目标，不管三七二十一的随机跳了很久。这期间，它可能走向高处，也可能踏进盆地。但是慢慢的，它明确了自己是一只有远大抱负的兔，然后往最高的地方跳去。这就是模拟退火。

## 伪代码

```c
// J(y)：在状态y时的评价函数值
// Y(i)：表示当前状态
// Y(i+1)：表示新的状态
// r： 用于控制降温的快慢
// T： 系统的温度，系统初始应该要处于一个高温的状态
// T_min ：温度的下限，若温度T达到T_min，则停止搜索

while( T > T_min ){
     dE = J( Y(i+1) ) - J( Y(i) );
     if ( dE >=0 )  //表达移动后得到更优解，则总是接受移动
        	Y(i+1) = Y(i) ; //接受从Y(i)到Y(i+1)的移动
     else{
     //函数exp( dE/T )的取值范围是(0,1) ，dE/T越大，则exp( dE/T )也大
      if (exp( dE/T ) > random( 0 , 1 ) )
          Y(i+1) = Y(i) ; //接受从Y(i)到Y(i+1)的移动
}
	//降温退火 ，0<r<1。r越大，降温越慢；r越小，降温越快
	T = r*T;

	//若r过大，则搜索到全局最优解的可能会较高，但搜索的过程也就较长。若r过小，则搜索的过程会很快
	//但最终可能会达到一个局部最优值

	i ++ ;
}
```

模拟退火是一种随机算法，它并不能保证能找到全局最优解，但是能比较快的找到近似最优解。如果参数设置得当巧妙的话，模拟退火算法的效率还是挺可观的。

------
::: tip 参考文献
[大白话解析模拟退火算法](http://www.cnblogs.com/heaad/archive/2010/12/20/1911614.html)

[模拟退火算法百度百科](https://baike.baidu.com/item/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB%E7%AE%97%E6%B3%95/355508?fr=aladdin)

[理解模拟退火算法](https://blog.csdn.net/ango_/article/details/75048082)
:::


